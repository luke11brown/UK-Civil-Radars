"use strict";function _classCallCheck(a,b){if(!a instanceof b){throw new TypeError("Cannot call a class as a function")}}(function(b,a,c,e){var d=function(){var o=[];var m=0;var j=0;var p=[];function k(){_classCallCheck(this,k)}function n(q){if(q===e){q=[];o.forEach(function(s,r){if(s.autorefresh==2&&typeof s.category!=="undefined"){q.push({id:s.dataid,prefix:"",category:s.category})}})}return c.ajax({url:"ajax.php",method:"POST",data:{"do":"adsmanager",json:1,s:SESSIONURL||"",securitytoken:SECURITYTOKEN,ads:q}}).then(function(u,r,t){var s=c.parseJSON(u);if(t.status==200){return s||[]}return[]}).fail(function(r){console.error("Error occurred while loading new ads",r)})}function i(r){if(typeof r==="undefined"){return}for(var q=0;q<r.length;q++){c('[data-am-unit="'+r[q].findid+'"]').html(r[q].code)}}function f(){var q=c(b).scrollTop(),r=[];if(Math.abs(q-j)>p.refresh_scroll){o.forEach(function(t,s){if(typeof t.category!=="undefined"){r.push({id:t.dataid,prefix:q,category:t.category})}else{if(!t.smart&&typeof t.refresh==="function"){t.refresh()}}});j=q}if(r.length){n(r).then(i)}o.forEach(function(t,s){if(t.smart&&typeof t.refresh==="function"&&g("#"+t.elemid)){t.refresh();t.smart=0;if(t.autorefresh!=1){t.refresh=null}}})}function h(x,w,s){var r=b.vB_Thread_Store.fetch_threadinfo(w,s);var u,t,q,v;if(p.do_showpage&&typeof p.do_showpage==="function"){p.do_showpage()}if(typeof r.adunits!=="undefined"){for(u=0,t=r.adunits.length;u<t;++u){q=r.adunits[u];v=c.grep(o,function(y){return y.dataid==q});if(v.length>0&&typeof v[0].showPage==="function"){v[0].showPage()}}}}function l(s,t){var r=t.split("-");var q=b.vB_Thread_Store.fetch_threadinfo(r[0],r[1]);if(typeof q.adunits!=="undefined"&&p.do_destroy&&typeof p.do_destroy==="function"){p.do_destroy(q.adunits)}}function g(s){if(!c(s).length){return false}var u=c(b).scrollTop(),t=u+c(b).height();var q=c(s).offset().top-p.view_offset,r=q+c(s).height()+p.view_offset;return((q<t)&&(r>u))}k.prototype.init=function(q){p.refresh_scroll=0;p.infinite_scroll=false;p.do_showpage=false;p.do_reset=false;p.view_offset=0;c.extend(p,q);if(p.infinite_scroll){c(a).on("InfiniteScroll.ShowPageComplete",h);c(a).on("InfiniteScroll.RemovePageComplete",l)}if(p.refresh_scroll){b.addEventListener("scroll",function(){if(m){clearTimeout(m)}m=setTimeout(f,100)},false)}if(p.do_reset&&typeof p.do_reset==="function"){this.reset=p.do_reset}if(p.do_destroy&&typeof p.do_destroy==="function"){this.destroy=p.do_destroy}};k.prototype.register=function(t,q,r){var s={};c.extend(s,t);s.showPage=q;s.refresh=r;o.push(s)};k.prototype.showAds=function(){n().then(i)};k.prototype.reset=function(q){};k.prototype.destroy=function(q){};return k}();b.vB_AdsController=new d()}(window,document,window.jQuery));